<!DOCTYPE html>

<html>

<head>
  <meta charset="utf-8">
  <title>Poissons</title>
  <link rel="stylesheet" href="style.css">
  <script type="text/javascript" src="js/utils.js"></script>
  <script type="text/javascript" src="js/FishShoal.js"></script>
  <script type="text/javascript" src="js/Fish.js"></script>
  <script type="text/javascript" src="js/selection.js"></script>
  <script type="text/javascript" src="js/NeuralNetwork.js"></script>
</head>

<body>

  <div id="display-1">
    <div class="nbPoisson"></div>
    <div class="inputs">

      <div class="slider">
        <label for="slider-cohesion">Cohesion</label>
        <input name="slider-cohesion" class="slider-cohesion" type="range" min="0" max="0.01" value="0.0005" step="0.0005">
  
      </div>

      <div class="slider">
        <label for="slider-separation">Separation</label>
        <input name="slider-separation" class="slider-separation" type="range" min="0" max="0.01" value="0.0005"
          step="0.0005">
      </div>

      <div class="slider">
        <label for="slider-alignment">Alignment</label>
        <input name="slider-alignment" class="slider-alignment" type="range" min="0" max="0.01" value="0.0005"
          step="0.0005">
  
      </div>

      <div class="slider">
        <label for="slider-mutChance">Mutation rate</label>
        <input name="slider-mutChance" class="slider-mutChance" type="range" min="0" max="1" value="0.01" step="0.005">  
      </div>
  
      <input type="button" value="Next Year" id="button-next-year" class="button-next-year">
      
      <input type="button" value="Display Species" id="display-species">

    </div>

    <canvas id="canvas-1"></canvas>

  </div>

  <div id="display-2">
    <div id="container-2">
      <h1>Esp√®ces de poissons</h1>
      <div class="species-tabs"></div>
      <div id="close-display-2" class="close"></div>
    </div>
  </div>

  <script type="module" src="main.js"></script>

    // CONTROL
    
    var controls = new OrbitControls(camera, renderer.domElement);

    // LIGHT

    const pointLight = new THREE.PointLight(0x00ff00, 2, 50);
    const directionalLight = new THREE.DirectionalLight(0xffffff);
    const ambientLight = new THREE.AmbientLight(0x111111);
    scene.add(ambientLight);
    scene.add(pointLight);
    scene.add(directionalLight);

    
    // SLIDERS

    const slider_s = document.querySelector(".slider-separation");
    const slider_ag = document.querySelector(".slider-cohesion");
    const slider_al = document.querySelector(".slider-alignment");
    const slider_mutChance = document.querySelector(".slider-mutChance");
    
    slider_ag.addEventListener('change', () => {
      c_ag = slider_ag.value;
    })
    slider_s.addEventListener('change', () => {
      c_s = slider_s.value;
    })
    slider_al.addEventListener('change', () => {
      c_al = slider_al.value;
    })

    slider_mutChance.addEventListener('change', () => {
      FishShoal.setMutChance(slider_mutChance.value);
      console.log("val slider"+slider_mutChance.value);
    })

    let c_ag = slider_ag.value; let c_s = slider_s.value; let c_al = slider_al.value;

    //BUTTONS
    var  btnNextYear = document.querySelector(".button-next-year");
    //console.log(btnNextYear);
    if (btnNextYear!= null){
      btnNextYear.addEventListener('click', () => {
        FishShoal.nextYear();
        deleteGroup();
        displayFishes();
        document.querySelector('.nbPoisson').innerHTML= FishShoal.getNbFishToString() ;
      });
    }
    

    // ANIMATION

    function animate() {
      
      requestAnimationFrame(animate);
      FishShoal.updatePosition(c_ag, c_s,c_al,fishesGroup);
      
      // Here, the code for animation

      renderer.render(scene, camera);
      
    }

    FishShoal.init(100);
    displayFishes();

    animate();
    document.addEventListener('keydown', () => {
      FishShoal.nextYear();
      deleteGroup();
      displayFishes();
    });

    FishShoal.setMutChance(slider_mutChance.value);
    //TEXT INFORMATION
    document.querySelector('.nbPoisson').innerHTML= FishShoal.getNbFishToString() ;

  </script>

</body>

</html>